<!DOCTYPE html>
<html lang="en" dir="ltr" class="light">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title>Treasury Document Wizard - Login</title>

		<!-- Core CSS -->
		<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}">
	</head>
	<body>
		<div id="root">
			<!-- App Layout-->
			<div class="app-layout-blank flex flex-auto flex-col h-[100vh]">
                <div class="h-full flex flex-auto flex-col justify-between">
                    <main class="h-full">
                        <div class="page-container relative h-full flex flex-auto flex-col">
                            <div class="grid lg:grid-cols-3 h-full">
                                <div class="bg-no-repeat bg-cover py-6 px-16 flex-col justify-between hidden lg:flex" style="background-image: url('{{ url_for('static', filename='img/others/auth-side-bg.jpg') }}');">
          
                                    <div>
                                        <div class="mb-6 flex items-center gap-4">
                                            <span class="avatar avatar-circle avatar-md border-2 border-white">
                                                <span class="avatar avatar-circle bg-teal-500 dark:bg-teal-500" data-avatar-size="30"">
                                                    <span class="avatar-string">{{ user_info.get('shortname', '') }}</span>
                                                </span>
                                            </span>
                                            <div class="text-white">
                                                <div class="font-semibold text-base">{{ user_info.get('first_name', '') }} {{ user_info.get('last_name', '') }}</div>
                                                <span class="opacity-80">{{ user_info.get('role', '') }}</span>
                                            </div>                                            
                                        </div>
                                        <div class="col-span-4">
                                            <div class="max-w-[900px]">
                                                <div class="mb-8 text-white">
                                                    <div class="mb-4 font-semibold uppercase">Status</div>
                                                    <ul class="timeline ">
                                                        <li class="timeline-item">
                                                            <div class="timeline-item-wrapper">
                                                                <div class="timeline-item-media">
                                                                    <div class="timeline-item-media-content">
                                                                        <span class="avatar avatar-circle text-gray-700 bg-gray-200 dark:text-gray-100" style="width: 30px; height: 30px; min-width: 30px; line-height: 30px; font-size: 15px;">
                                                                            <span class="avatar-icon avatar-icon-30">
                                                                                <svg
                                                                                    stroke="currentColor"
                                                                                    fill="currentColor"
                                                                                    stroke-width="0"
                                                                                    viewBox="0 0 20 20"
                                                                                    aria-hidden="true"
                                                                                    height="1em"
                                                                                    width="1em"
                                                                                    xmlns="http://www.w3.org/2000/svg"
                                                                                >
                                                                                    <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd"></path>
                                                                                </svg>
                                                                            </span>
                                                                        </span>
                                                                    </div>
                                                                    <div class="timeline-connect"></div>
                                                                </div>
                                                                <div class="timeline-item-content">
                                                                    <div class="mt-1 ">
                                                                        <div class="flex items-center">
                                                                            <span class="ml-3 rtl:mr-3">STEP 1: Document Title</span>
                                                                            <div class="tag mx-1">
                                                                                <span class="tag-affix tag-prefix bg-green-500"></span>Completed
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </li>
                                                        <li class="timeline-item">
                                                            <div class="timeline-item-wrapper">
                                                                <div class="timeline-item-media">
                                                                    <div class="timeline-item-media-content">
                                                                        <span class="avatar avatar-circle text-gray-700 bg-gray-200 dark:text-gray-100" style="width: 30px; height: 30px; min-width: 30px; line-height: 30px; font-size: 15px;">
                                                                            <span class="avatar-icon avatar-icon-30">
                                                                                <svg
                                                                                    stroke="currentColor"
                                                                                    fill="currentColor"
                                                                                    stroke-width="0"
                                                                                    viewBox="0 0 20 20"
                                                                                    aria-hidden="true"
                                                                                    height="1em"
                                                                                    width="1em"
                                                                                    xmlns="http://www.w3.org/2000/svg"
                                                                                >
                                                                                    <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd"></path>
                                                                                </svg>
                                                                            </span>
                                                                        </span>
                                                                    </div>
                                                                    <div class="timeline-connect"></div>
                                                                </div>
                                                                <div class="timeline-item-content">
                                                                    <div class="mt-1 ">
                                                                        <div class="flex items-center">
                                                                            <span class="ml-3 rtl:mr-3">STEP 2: Select a Control</span>
                                                                            <div class="tag mx-1">
                                                                                <span class="tag-affix tag-prefix bg-green-500"></span>Completed
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </li>
                                                        <li class="timeline-item">
                                                            <div class="timeline-item-wrapper">
                                                                <div class="timeline-item-media">
                                                                    <div class="timeline-item-media-content">
                                                                        <span class="avatar avatar-circle text-gray-700 bg-gray-200 dark:text-gray-100" style="width: 30px; height: 30px; min-width: 30px; line-height: 30px; font-size: 15px;">
                                                                            <span class="avatar-icon avatar-icon-30">
                                                                                <svg
                                                                                    stroke="currentColor"
                                                                                    fill="currentColor"
                                                                                    stroke-width="0"
                                                                                    viewBox="0 0 20 20"
                                                                                    aria-hidden="true"
                                                                                    height="1em"
                                                                                    width="1em"
                                                                                    xmlns="http://www.w3.org/2000/svg"
                                                                                >
                                                                                    <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd"></path>
                                                                                </svg>
                                                                            </span>
                                                                        </span>
                                                                    </div>
                                                                    <div class="timeline-connect"></div>
                                                                </div>
                                                                <div class="timeline-item-content">
                                                                    <div class="mt-1 ">
                                                                        <div class="flex items-center">
                                                                            <span class="ml-3 rtl:mr-3">STEP 3: Document Checks</span>
                                                                            <div class="tag mx-1">
                                                                                <span class="tag-affix tag-prefix bg-green-500"></span>Completed
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </li>
                                                        <li class="timeline-item">
                                                            <div class="timeline-item-wrapper">
                                                                <div class="timeline-item-media">
                                                                    <div class="timeline-item-media-content">
                                                                        <span class="avatar avatar-circle text-gray-700 bg-gray-200 dark:text-gray-100" style="width: 30px; height: 30px; min-width: 30px; line-height: 30px; font-size: 15px;">
                                                                            <span class="avatar-icon avatar-icon-30">
                                                                                <svg
                                                                                    stroke="currentColor"
                                                                                    fill="currentColor"
                                                                                    stroke-width="0"
                                                                                    viewBox="0 0 20 20"
                                                                                    aria-hidden="true"
                                                                                    height="1em"
                                                                                    width="1em"
                                                                                    xmlns="http://www.w3.org/2000/svg"
                                                                                >
                                                                                    <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd"></path>
                                                                                </svg>
                                                                            </span>
                                                                        </span>
                                                                    </div>
                                                                    <div class="timeline-connect"></div>
                                                                </div>
                                                                <div class="timeline-item-content">
                                                                    <div class="mt-1 ">
                                                                        <div class="flex items-center">
                                                                            <span class="ml-3 rtl:mr-3">STEP 4: Final Review</span>
                                                                            <div class="tag mx-1">
                                                                                <span class="tag-affix tag-prefix bg-blue-500"></span>In- Progress
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </li>
                                                        <li class="timeline-item timeline-item-last">
                                                            <div class="flex flex-auto items-center gap-2">
                                                                <div>
                                                                    <span class="skeleton skeleton-circle animate-pulse w-[35px] h-[35px]"></span>
                                                                </div>
                                                                <div class="flex flex-col gap-4 w-full">
                                                                    <span class="skeleton skeleton-block animate-pulse w-[60%] h-[10px]"></span>
                                                                </div>
                                                            </div>
                                                        </li>
                                                    </ul>
                                                </div></div></div></div>
                                </div>
                                <div class="col-span-2 flex flex-col justify-center items-center bg-white dark:bg-gray-800">
                                    <div class="xl:min-w-[450px] px-8">
                                        
                                        <div>
                                            <div class="card-body">
                                                <div class="card card-border">
                                                    <div class="card-header card-header-border card-header-extra">
                                                        <h4>Document Review</h4>
                                                        <span>
                                                            <span class="flex items-center">
                                                                <span class="mr-1 font-semibold">Status:</span>
                                                                <span class="text-emerald-500 text-xl">
                                                                    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 20 20" aria-hidden="true" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg">
                                                                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                                                    </svg>
                                                                </span>
                                                            </span>
                                                        </span>
                                                    </div>
                                                    <div class="card-body">
                                                        <img class="mx-auto" src="{{ url_for('static', filename='img/logo/pearsonreport.png') }}" alt="logo" style="width: 200px;">
                                                        
                                                        
                                                        <p><strong>Document Title:</strong> {{ responses.document_title }}</p><br>
                                                            <!-- Include Document Type conditionally -->
                                                            {% if responses.radio_selection == 'Others' and responses.other_input %}
                                                            <p><strong>Document Type - Others:</strong> {{ responses.other_input }}</p><br>
                                                        {% else %}
                                                            <p><strong>Document Type:</strong> {{ responses.radio_selection }}</p><br>
                                                        {% endif %}
                                                        <!-- ...other parts of your file note... -->
                                                        <p><strong>Relates to which control:</strong> {{ responses.dropdown_selection }}</p><br>
                                                        <p><strong>Control Code:</strong> {{ responses.control_code }}</p><br>
                                                        <p><strong>Control Frequency:</strong> {{ responses.control_frequency }}</p><br>
                                                        <p><strong>Control Description:</strong> {{ responses.control_description }}</p><br>
                                                        <!-- Include conditional parts based on control_operated and control_effectiveness -->
                                                        {% if responses.control_operated == 'No' %}
                                                            <p><strong>Has the control operated as described during the period under assessment?</strong><br/> No: {{ responses.no_explanation }}</p><br>
                                                        {% else %}
                                                            <p><strong>Has the control operated as described during the period under assessment?</strong> {{ responses.control_operated }}</p><br>
                                                        {% endif %}
                                                        <p><strong>How many supporting schedules have been prepared by Pearson?</strong> {{ responses.support_schedules }}</p><br>
                                                    
                                                        <!-- Schedule information -->
                                                        {% for i in range(responses.support_schedules | int) %}
                                                            <p><strong>What is the underlying source of the supporting schedule (schedule {{ i + 1 }})?</strong></p>
                                                            {% set schedule_key = 'schedule_' ~ i ~ '_selections' %}
                                                            {% for selection in responses[schedule_key] %}
                                                                <p> - {{ selection }}</p>
                                                            {% endfor %}<br>
                                                        {% endfor %}
                                                        <p><strong>Have any calculations been re-performed to ensure that totals have been properly calculated?</strong> {{ responses.calc_re_performed }}</p><br>
                                                        
                                                        {% if responses.additional_info == 'Confirmed' %}
                                                        <p><strong>I have reviewed the user entitlements report and confirm that all access is appropriate and needs to be retained </strong> {{ responses.additional_info }}</p><br>
                                                        {% elif responses.additional_info == 'Following review and updates to access, this is now confirmed' %}
                                                        <p><strong>I have reviewed the user entitlements report and confirm that all access is appropriate and needs to be retained </strong> {{ responses.additional_info }}</p><br>
                                                        {% else %}
                                                        <p></p>
                                                        {% endif %}

                                                        {% if responses.control_effectiveness == 'Yes having resolved small issues' %}
                                                        <p><strong>Based on the work performed, are you comfortable that the control is working effectively?</strong><br/> Yes having resolved small issues: {{ responses.small_issues_explanation }}</p><br>
                                                        {% elif responses.control_effectiveness == 'Yes having resolved major issues' %}
                                                            <p><strong>Based on the work performed, are you comfortable that the control is working effectively?</strong><br/> Yes having resolved major issues: {{ responses.major_issues_explanation }}</p><br>
                                                        {% else %}
                                                            <p><strong>Based on the work performed, are you comfortable that the control is working effectively?</strong> {{ responses.control_effectiveness }}</p><br>
                                                        {% endif %}
                                                        <p><strong>Completed By:</strong></p> 
                                                        <p>{{ user_info.get('first_name', '') }} {{ user_info.get('last_name', '') }}<br/>
                                                            {{ user_info.get('role', '') }}<br/>
                                                            {{ user_info.get('username', '') }}<br/>
                                                        </p>
                                                        <p><strong>Date:</strong> {{ today }}</p>
                                                    </div>
                                                    <div class="card-footer card-footer-border">
                                                        <div class="flex justify-end">
                                                            <a href="{{ url_for('documentwiz.signin_side3') }}" class="btn btn-default btn-sm ltr:mr-2 rtl:ml-2">Cancel</a>
                                                            <a href="{{ url_for('documentwiz.download_pdf') }}" onclick="downloadAndRedirect()" class="button bg-primary-600 hover:bg-primary-500 active:bg-primary-700 text-white radius-round h-9 px-3 py-2 text-sm">Download PDF</a>
                                                        </div>
                                                    </div>
                                                    
                                                    
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </main>
                </div>                              
			</div>
		</div>

        <script>
            function downloadAndRedirect() {
                // Start the download
                var link = document.createElement('a');
                link.href = '{{ url_for('documentwiz.download_pdf') }}';
                link.download = 'download';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            
                // Redirect after a short delay to allow the download to start
                setTimeout(function() {
                    window.location.href = '{{ url_for('documentwiz.signin_side5') }}';
                }, 1000); // Adjust delay as needed
            }
            </script>
            
        
		<script src="{{ url_for('static', filename='js/vendors.min.js') }}"></script>

		<!-- Core JS -->
		<script src="{{ url_for('static', filename='js/app.min.js') }}"></script>
	</body>

</html>